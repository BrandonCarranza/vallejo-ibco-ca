# IBCo Vallejo Console - Environment Configuration
# Copy this file to .env and update with your local settings
# NEVER commit .env to version control - it contains secrets!

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

# Environment: development, staging, production
ENVIRONMENT=development

# Application name
APP_NAME="IBCo Vallejo Console"

# API Version
API_VERSION=v1

# Debug mode (set to False in production)
DEBUG=True

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=DEBUG

# Secret key for session management (generate with: openssl rand -hex 32)
SECRET_KEY=your-secret-key-here-change-in-production

# CORS allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# ============================================================================
# DATABASE SETTINGS
# ============================================================================

# PostgreSQL connection settings
POSTGRES_USER=ibco
POSTGRES_PASSWORD=ibco_dev_password
POSTGRES_DB=ibco_vallejo
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# Full database URL (constructed from above or set directly)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# Async database URL for async operations
DATABASE_URL_ASYNC=postgresql+asyncpg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# Database pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ============================================================================
# REDIS SETTINGS
# ============================================================================

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=ibco_redis_dev
REDIS_DB=0

# Full Redis URL
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Redis cache TTL (seconds)
REDIS_CACHE_TTL=3600

# ============================================================================
# CELERY SETTINGS (Task Queue)
# ============================================================================

# Celery broker (Redis database 1)
CELERY_BROKER_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/1

# Celery result backend (Redis database 2)
CELERY_RESULT_BACKEND=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/2

# Celery task settings
CELERY_TASK_ALWAYS_EAGER=False
CELERY_TASK_EAGER_PROPAGATES=True
CELERY_TASK_RESULT_EXPIRES=3600

# ============================================================================
# API SERVER SETTINGS
# ============================================================================

# API host and port
API_HOST=0.0.0.0
API_PORT=8000

# API workers (for production)
API_WORKERS=4

# Request timeout (seconds)
API_TIMEOUT=60

# Max request body size (bytes)
MAX_REQUEST_SIZE=10485760

# Rate limiting
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_MINUTE=60

# ============================================================================
# METABASE SETTINGS (Business Intelligence Dashboard)
# ============================================================================

METABASE_PORT=3000
METABASE_DB=metabase

# Metabase encryption key (generate with: openssl rand -base64 32)
METABASE_ENCRYPTION_KEY=change_this_in_production

# ============================================================================
# PGADMIN SETTINGS (Database Management)
# ============================================================================

PGADMIN_PORT=5050
PGADMIN_EMAIL=admin@ibco-ca.us
PGADMIN_PASSWORD=admin_dev_password

# ============================================================================
# FLOWER SETTINGS (Celery Monitoring)
# ============================================================================

FLOWER_PORT=5555
FLOWER_USER=admin
FLOWER_PASSWORD=admin

# ============================================================================
# DATA SOURCES & SCRAPING
# ============================================================================

# City of Vallejo CAFR URLs base
VALLEJO_CAFR_BASE_URL=https://www.cityofvallejo.net/

# CalPERS API settings (if available)
CALPERS_API_URL=https://www.calpers.ca.gov/
CALPERS_API_KEY=

# State Controller API
STATE_CONTROLLER_API_URL=https://bythenumbers.sco.ca.gov/

# User agent for web scraping (be respectful!)
USER_AGENT="IBCo-Data-Collector/1.0 (+https://ibco-ca.us)"

# Request rate limiting for scrapers (requests per second)
SCRAPER_RATE_LIMIT=1

# Request timeout for external APIs (seconds)
EXTERNAL_API_TIMEOUT=30

# ============================================================================
# FILE STORAGE SETTINGS
# ============================================================================

# Base directory for data storage
DATA_DIR=./data

# Raw data directory
RAW_DATA_DIR=${DATA_DIR}/raw

# Processed data directory
PROCESSED_DATA_DIR=${DATA_DIR}/processed

# Archive directory
ARCHIVE_DATA_DIR=${DATA_DIR}/archive

# Max file upload size (bytes) - 50MB
MAX_FILE_UPLOAD_SIZE=52428800

# ============================================================================
# DATA VALIDATION SETTINGS
# ============================================================================

# Enable strict data validation
STRICT_VALIDATION=True

# Validation error threshold (percentage)
MAX_VALIDATION_ERROR_RATE=0.01

# Enable data quality logging
DATA_QUALITY_LOGGING=True

# ============================================================================
# RISK SCORING SETTINGS
# ============================================================================

# Risk score calculation version
RISK_SCORE_VERSION=1.0

# Risk score weights (must sum to 1.0)
RISK_WEIGHT_LIQUIDITY=0.25
RISK_WEIGHT_STRUCTURAL=0.25
RISK_WEIGHT_PENSION=0.30
RISK_WEIGHT_REVENUE=0.10
RISK_WEIGHT_DEBT=0.10

# ============================================================================
# PROJECTION SETTINGS
# ============================================================================

# Default projection horizon (years)
PROJECTION_YEARS=10

# Discount rate for NPV calculations
DISCOUNT_RATE=0.068

# Inflation assumption (annual percentage)
INFLATION_RATE=0.03

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================

# Enable performance monitoring
ENABLE_PERFORMANCE_MONITORING=True

# Sentry DSN (error tracking)
SENTRY_DSN=

# Sentry environment
SENTRY_ENVIRONMENT=${ENVIRONMENT}

# Sentry sample rate (0.0 to 1.0)
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# EMAIL SETTINGS (for notifications)
# ============================================================================

# SMTP settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@ibco-ca.us
SMTP_FROM_NAME="IBCo Vallejo Console"

# Enable email notifications
ENABLE_EMAIL_NOTIFICATIONS=False

# Admin email addresses (comma-separated)
ADMIN_EMAILS=admin@ibco-ca.us

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# Enable HTTPS redirect (production only)
FORCE_HTTPS=False

# JWT settings
JWT_SECRET_KEY=${SECRET_KEY}
JWT_ALGORITHM=HS256
JWT_EXPIRATION_MINUTES=60

# API key for internal services
INTERNAL_API_KEY=

# Enable API authentication
REQUIRE_API_AUTH=False

# ============================================================================
# BACKUP & ARCHIVAL SETTINGS
# ============================================================================

# Enable automated backups
ENABLE_AUTO_BACKUP=True

# Backup frequency (hours)
BACKUP_FREQUENCY_HOURS=24

# Backup retention (days)
BACKUP_RETENTION_DAYS=90

# Archive.org credentials (for public data archival)
ARCHIVE_ORG_ACCESS_KEY=
ARCHIVE_ORG_SECRET_KEY=

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable experimental features
ENABLE_EXPERIMENTAL_FEATURES=False

# Enable PDF extraction (requires additional setup)
ENABLE_PDF_EXTRACTION=False

# Enable web scraping
ENABLE_WEB_SCRAPING=False

# Enable automated projections
ENABLE_AUTO_PROJECTIONS=True

# ============================================================================
# DEVELOPMENT SETTINGS (only for development/testing)
# ============================================================================

# Seed database with sample data
SEED_SAMPLE_DATA=True

# Enable debug toolbar
ENABLE_DEBUG_TOOLBAR=True

# Reload on code changes
AUTO_RELOAD=True

# Use test database
USE_TEST_DB=False

# ============================================================================
# NOTES
# ============================================================================
#
# - After copying this file to .env, update all passwords and secrets
# - Generate secrets with: openssl rand -hex 32
# - Never commit .env to version control
# - Document any new environment variables added to the project
# - Validate .env on startup to catch configuration errors early
#
# For production deployment:
# - Set ENVIRONMENT=production
# - Set DEBUG=False
# - Use strong, unique passwords for all services
# - Enable HTTPS (FORCE_HTTPS=True)
# - Configure proper CORS origins
# - Set up monitoring (Sentry)
# - Enable backups
# - Review and adjust all security settings
