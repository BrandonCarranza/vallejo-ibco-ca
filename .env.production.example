# IBCo Production Environment Variables
# Copy this file to .env for production deployment
# NEVER commit .env to version control!

# ============================================================================
# CRITICAL: Replace ALL placeholder values before deployment
# ============================================================================

# Environment
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO

# Secret Key (REQUIRED - generate with: openssl rand -hex 32)
SECRET_KEY=CHANGE_ME_MINIMUM_32_CHARACTERS_RANDOM_STRING

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

DATABASE_NAME=ibco_production
DATABASE_USER=ibco_user
DATABASE_PASSWORD=CHANGE_ME_STRONG_DATABASE_PASSWORD
DATABASE_HOST=postgres
DATABASE_PORT=5432

# Database URL (auto-constructed in docker-compose)
DATABASE_URL=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}

# Connection pool settings
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================

REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_STRONG_REDIS_PASSWORD
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/0

# ============================================================================
# API CONFIGURATION
# ============================================================================

API_HOST=0.0.0.0
API_PORT=8000

# CORS Origins (comma-separated, no spaces)
CORS_ORIGINS=https://ibco-ca.us,https://www.ibco-ca.us

# ============================================================================
# CELERY (Background Tasks)
# ============================================================================

CELERY_BROKER_URL=redis://:${REDIS_PASSWORD}@redis:6379/1
CELERY_RESULT_BACKEND=redis://:${REDIS_PASSWORD}@redis:6379/2

# ============================================================================
# MONITORING & OBSERVABILITY (Optional but recommended)
# ============================================================================

# Grafana admin password
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_STRONG_GRAFANA_PASSWORD

# Sentry for error tracking
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# EMAIL NOTIFICATIONS (Optional)
# ============================================================================

SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@ibco-ca.us
ENABLE_EMAIL_NOTIFICATIONS=false

# Admin emails for alerts (comma-separated)
ADMIN_EMAILS=admin@ibco-ca.us

# ============================================================================
# SSL/TLS CERTIFICATES
# ============================================================================

# Paths to SSL certificates (mounted via docker volume)
SSL_CERTIFICATE_PATH=/etc/nginx/ssl/fullchain.pem
SSL_CERTIFICATE_KEY_PATH=/etc/nginx/ssl/privkey.pem

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================

ENABLE_AUTO_BACKUP=true
BACKUP_FREQUENCY_HOURS=24
BACKUP_RETENTION_DAYS=30

# ============================================================================
# METABASE CONFIGURATION
# ============================================================================

# Metabase encryption key (generate with: openssl rand -base64 32)
METABASE_ENCRYPTION_KEY=CHANGE_ME_METABASE_ENCRYPTION_KEY

# ============================================================================
# FEATURE FLAGS
# ============================================================================

ENABLE_EXPERIMENTAL_FEATURES=false
ENABLE_PDF_EXTRACTION=false
ENABLE_WEB_SCRAPING=false
ENABLE_AUTO_PROJECTIONS=true

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

FORCE_HTTPS=true
REQUIRE_API_AUTH=false
STRICT_VALIDATION=true

# ============================================================================
# DATA DIRECTORIES
# ============================================================================

DATA_DIR=/app/data
RAW_DATA_DIR=${DATA_DIR}/raw
PROCESSED_DATA_DIR=${DATA_DIR}/processed
ARCHIVE_DATA_DIR=${DATA_DIR}/archive

# ============================================================================
# DEPLOYMENT CHECKLIST
# ============================================================================
#
# Before deploying to production:
# ✓ Replace ALL "CHANGE_ME_*" values with strong, unique values
# ✓ Generate SECRET_KEY with: openssl rand -hex 32
# ✓ Set strong DATABASE_PASSWORD (min 20 chars, alphanumeric + symbols)
# ✓ Set strong REDIS_PASSWORD (min 20 chars)
# ✓ Configure CORS_ORIGINS with actual domain
# ✓ Place SSL certificates in infrastructure/nginx/ssl/
# ✓ Set up Sentry DSN for error tracking (recommended)
# ✓ Configure SMTP settings for email notifications (optional)
# ✓ Review and adjust backup settings
# ✓ Test deployment in staging environment first
# ✓ Create initial database backup before first deployment
#
